geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "red") +
geom_text(aes(label = variable), vjust = -0.5, color = "red") +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("A) PCA – Contribución de las variables") +
theme_minimal()
# Extraer coordenadas de los individuos "B#R#":
ind_coord <- as.data.frame(pca_res$x[, 1:2])
ind_coord$ID <- papa$ID
ind_coord$BLOQUE <- papa$BLOQUE
GraficoB <- ggplot(ind_coord, aes(x = PC1, y = PC2, label = ID, color = as.factor(BLOQUE))) +
geom_point(size = 2) +
geom_text(vjust = -0.3, size = 3) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("B) PCA – Distribución de unidades experimentales (B x R)") +
theme_minimal() +
guides(color = guide_legend(title = "Bloque"))
plot_grid(GraficoA, GraficoB, labels = c("A", "B"), ncol = 1)
loadings <- as.data.frame(pca_res$rotation[, 1:2])
loadings$variable <- rownames(loadings)
# Gráfico de flechas:
GraficoA <- ggplot(loadings, aes(x = PC1, y = PC2)) +
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "red") +
geom_text(aes(label = variable), vjust = -0.5, color = "red") +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("A) PCA – Contribución de las variables") +
theme_minimal()
# Extraer coordenadas de los individuos "B#R#":
ind_coord <- as.data.frame(pca_res$x[, 1:2])
ind_coord$ID <- papa$ID
ind_coord$BLOQUE <- papa$BLOQUE
GraficoB <- ggplot(ind_coord, aes(x = PC1, y = PC2, label = ID, color = as.factor(BLOQUE))) +
geom_point(size = 1) +
geom_text(vjust = -0.3, size = 3) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("B) PCA – Distribución de unidades experimentales (B x R)") +
theme_minimal() +
guides(color = guide_legend(title = "Bloque"))
plot_grid(GraficoA, GraficoB, labels = c("A", "B"), ncol = 1)
loadings <- as.data.frame(pca_res$rotation[, 1:2])
loadings$variable <- rownames(loadings)
# Gráfico de flechas:
GraficoA <- ggplot(loadings, aes(x = PC1, y = PC2)) +
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "red") +
geom_text(aes(label = variable), vjust = -0.5, color = "red") +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("A) PCA – Contribución de las variables") +
theme_minimal()
# Extraer coordenadas de los individuos "B#R#":
ind_coord <- as.data.frame(pca_res$x[, 1:2])
ind_coord$ID <- papa$ID
ind_coord$BLOQUE <- papa$BLOQUE
GraficoB <- ggplot(ind_coord, aes(x = PC1, y = PC2, label = ID, color = as.factor(BLOQUE))) +
geom_point(size = 2) +
geom_text(vjust = -0.3, size = 1) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("B) PCA – Distribución de unidades experimentales (B x R)") +
theme_minimal() +
guides(color = guide_legend(title = "Bloque"))
plot_grid(GraficoA, GraficoB, labels = c("A", "B"), ncol = 1)
loadings <- as.data.frame(pca_res$rotation[, 1:2])
loadings$variable <- rownames(loadings)
# Gráfico de flechas:
GraficoA <- ggplot(loadings, aes(x = PC1, y = PC2)) +
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "red") +
geom_text(aes(label = variable), vjust = -0.5, color = "red") +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("A) PCA – Contribución de las variables") +
theme_minimal()
# Extraer coordenadas de los individuos "B#R#":
ind_coord <- as.data.frame(pca_res$x[, 1:2])
ind_coord$ID <- papa$ID
ind_coord$BLOQUE <- papa$BLOQUE
GraficoB <- ggplot(ind_coord, aes(x = PC1, y = PC2, label = ID, color = as.factor(BLOQUE))) +
geom_point(size = 2) +
geom_text(vjust = -0.3, size = 2) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("B) PCA – Distribución de unidades experimentales (B x R)") +
theme_minimal() +
guides(color = guide_legend(title = "Bloque"))
plot_grid(GraficoA, GraficoB, labels = c("A", "B"), ncol = 1)
loadings <- as.data.frame(pca_res$rotation[, 1:2])
loadings$variable <- rownames(loadings)
# Gráfico de flechas:
GraficoA <- ggplot(loadings, aes(x = PC1, y = PC2)) +
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "green") +
geom_text(aes(label = variable), vjust = -0.5, color = "red") +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("A) PCA – Contribución de las variables") +
theme_minimal()
# Extraer coordenadas de los individuos "B#R#":
ind_coord <- as.data.frame(pca_res$x[, 1:2])
ind_coord$ID <- papa$ID
ind_coord$BLOQUE <- papa$BLOQUE
GraficoB <- ggplot(ind_coord, aes(x = PC1, y = PC2, label = ID, color = as.factor(BLOQUE))) +
geom_point(size = 2) +
geom_text(vjust = -0.3, size = 2) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("B) PCA – Distribución de unidades experimentales (B x R)") +
theme_minimal() +
guides(color = guide_legend(title = "Bloque"))
plot_grid(GraficoA, GraficoB, labels = c("A", "B"), ncol = 1)
loadings <- as.data.frame(pca_res$rotation[, 1:2])
loadings$variable <- rownames(loadings)
# Gráfico de flechas:
GraficoA <- ggplot(loadings, aes(x = PC1, y = PC2)) +
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "green") +
geom_text(aes(label = variable), vjust = -0.5, color = "red") +
xlab(paste0("PC (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("A) PCA – Contribución de las variables") +
theme_minimal()
# Extraer coordenadas de los individuos "B#R#":
ind_coord <- as.data.frame(pca_res$x[, 1:2])
ind_coord$ID <- papa$ID
ind_coord$BLOQUE <- papa$BLOQUE
GraficoB <- ggplot(ind_coord, aes(x = PC1, y = PC2, label = ID, color = as.factor(BLOQUE))) +
geom_point(size = 2) +
geom_text(vjust = -0.3, size = 2) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("B) PCA – Distribución de unidades experimentales (B x R)") +
theme_minimal() +
guides(color = guide_legend(title = "Bloque"))
plot_grid(GraficoA, GraficoB, labels = c("A", "B"), ncol = 1)
loadings <- as.data.frame(pca_res$rotation[, 1:2])
loadings$variable <- rownames(loadings)
# Gráfico de flechas:
GraficoA <- ggplot(loadings, aes(x = PC1, y = PC2)) +
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "green") +
geom_text(aes(label = variable), vjust = -0.5, color = "red") +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("A) PCA – Contribución de las variables") +
theme_minimal()
# Extraer coordenadas de los individuos "B#R#":
ind_coord <- as.data.frame(pca_res$x[, 1:2])
ind_coord$ID <- papa$ID
ind_coord$BLOQUE <- papa$BLOQUE
GraficoB <- ggplot(ind_coord, aes(x = PC1, y = PC2, label = ID, color = as.factor(BLOQUE))) +
geom_point(size = 2) +
geom_text(vjust = -0.3, size = 2) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("B) PCA – Distribución de unidades experimentales (B x R)") +
theme_minimal() +
guides(color = guide_legend(title = "Bloque"))
plot_grid(GraficoA, GraficoB, labels = c("A", "B"), ncol = 1)
loadings <- as.data.frame(pca_res$rotation[, 1:2])
loadings$variable <- rownames(loadings)
# Gráfico de flechas:
GraficoA <- ggplot(loadings, aes(x = PC1, y = PC2)) +
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "green") +
geom_text(aes(label = variable), vjust = -1, color = "red") +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("A) PCA – Contribución de las variables") +
theme_minimal()
# Extraer coordenadas de los individuos "B#R#":
ind_coord <- as.data.frame(pca_res$x[, 1:2])
ind_coord$ID <- papa$ID
ind_coord$BLOQUE <- papa$BLOQUE
GraficoB <- ggplot(ind_coord, aes(x = PC1, y = PC2, label = ID, color = as.factor(BLOQUE))) +
geom_point(size = 2) +
geom_text(vjust = -0.3, size = 2) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("B) PCA – Distribución de unidades experimentales (B x R)") +
theme_minimal() +
guides(color = guide_legend(title = "Bloque"))
plot_grid(GraficoA, GraficoB, labels = c("A", "B"), ncol = 1)
loadings <- as.data.frame(pca_res$rotation[, 1:2])
loadings$variable <- rownames(loadings)
# Gráfico de flechas:
GraficoA <- ggplot(loadings, aes(x = PC1, y = PC2)) +
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "green") +
geom_text(aes(label = variable), vjust = -1, color = "red") +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("A) PCA – Contribución de las variables") +
theme_minimal()
# Extraer coordenadas de los individuos "B#R#":
ind_coord <- as.data.frame(pca_res$x[, 1:2])
ind_coord$ID <- papa$ID
ind_coord$BLOQUE <- papa$BLOQUE
GraficoB <- ggplot(ind_coord, aes(x = PC1, y = PC2, label = ID, color = as.factor(BLOQUE))) +
geom_point(size = 2) +
geom_text(vjust = -0.3, size = 2) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("B) PCA – Distribución de unidades experimentales (B x R)") +
theme_minimal() +
guides(color = guide_legend(title = "Bloque"))
plot_grid(GraficoA, GraficoB, labels = c("A", "B"), ncol = 1)
loadings <- as.data.frame(pca_res$rotation[, 1:2])
loadings$variable <- rownames(loadings)
# Gráfico de flechas:
GraficoA <- ggplot(loadings, aes(x = PC1, y = PC2)) +
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "green") +
geom_text(aes(label = variable), vjust = -1, color = "red", size = 2) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("A) PCA – Contribución de las variables") +
theme_minimal()
# Extraer coordenadas de los individuos "B#R#":
ind_coord <- as.data.frame(pca_res$x[, 1:2])
ind_coord$ID <- papa$ID
ind_coord$BLOQUE <- papa$BLOQUE
GraficoB <- ggplot(ind_coord, aes(x = PC1, y = PC2, label = ID, color = as.factor(BLOQUE))) +
geom_point(size = 2) +
geom_text(vjust = -0.3, size = 2) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("B) PCA – Distribución de unidades experimentales (B x R)") +
theme_minimal() +
guides(color = guide_legend(title = "Bloque"))
plot_grid(GraficoA, GraficoB, labels = c("A", "B"), ncol = 1)
loadings <- as.data.frame(pca_res$rotation[, 1:2])
loadings$variable <- rownames(loadings)
# Gráfico de flechas:
GraficoA <- ggplot(loadings, aes(x = PC1, y = PC2)) +
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.1, "cm")), color = "green") +
geom_text(aes(label = variable), vjust = -1, color = "red", size = 2) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("A) PCA – Contribución de las variables") +
theme_minimal()
# Extraer coordenadas de los individuos "B#R#":
ind_coord <- as.data.frame(pca_res$x[, 1:2])
ind_coord$ID <- papa$ID
ind_coord$BLOQUE <- papa$BLOQUE
GraficoB <- ggplot(ind_coord, aes(x = PC1, y = PC2, label = ID, color = as.factor(BLOQUE))) +
geom_point(size = 2) +
geom_text(vjust = -0.3, size = 2) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("B) PCA – Distribución de unidades experimentales (B x R)") +
theme_minimal() +
guides(color = guide_legend(title = "Bloque"))
plot_grid(GraficoA, GraficoB, labels = c("A", "B"), ncol = 1)
dtmv <- fb %>%
group_by(porcinaza, densidad) %>%
summarise(across(where(is.numeric)
, ~ mean(., na.rm = T))) %>%
unite("trat", c(porcinaza, densidad), remove = F) %>%
column_to_rownames("trat")
pca <- PCA(X = dtmv, scale.unit = T
, quali.sup = c(1, 2))
var <- plot(pca, choix = "var")
ind <- plot(pca, choix = "ind")
list(var, ind) %>%
plot_grid(plotlist = ., ncol = 2, labels = "auto")
loadings <- as.data.frame(pca_res$rotation[, 1:2])
loadings$variable <- rownames(loadings)
# Gráfico de flechas:
theta <- seq(0, 2*pi, length.out = 200)
circle <- data.frame(x = cos(theta), y = sin(theta))
GraficoA <- ggplot() +
geom_path(data = circle, aes(x = x, y = y), linetype = "dashed") +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.15, "cm")), color = "green") +
geom_text(data = loadings, aes(x = PC1, y = PC2, label = variable),
vjust = -0.5, color = "red", size = 3) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("A) PCA – Círculo de correlaciones") +
coord_equal() +
theme_minimal()
# Extraer coordenadas de los individuos "B#R#":
ind_coord <- as.data.frame(pca_res$x[, 1:2])
ind_coord$ID <- papa$ID
ind_coord$BLOQUE <- papa$BLOQUE
GraficoB <- ggplot(ind_coord, aes(x = PC1, y = PC2, label = ID, color = as.factor(BLOQUE))) +
geom_point(size = 2) +
geom_text(vjust = -0.3, size = 2) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("B) PCA – Distribución de unidades experimentales (B x R)") +
theme_minimal() +
guides(color = guide_legend(title = "Bloque"))
plot_grid(GraficoA, GraficoB, labels = c("A", "B"), ncol = 1)
loadings <- as.data.frame(pca_res$rotation[, 1:2])
loadings$variable <- rownames(loadings)
# Gráfico de flechas:
theta <- seq(0, 2*pi, length.out = 200)
circle <- data.frame(x = cos(theta), y = sin(theta))
GraficoA <- ggplot() +
geom_path(data = circle, aes(x = x, y = y), linetype = "dashed") +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.15, "cm")), color = "green") +
geom_text(data = loadings, aes(x = PC1, y = PC2, label = variable),
vjust = -0.5, color = "red", size = 3) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("A) PCA – Círculo de correlaciones") +
coord_equal() +
theme_minimal()
# Extraer coordenadas de los individuos "B#R#":
ind_coord <- as.data.frame(pca_res$x[, 1:2])
ind_coord$ID <- papa$ID
ind_coord$BLOQUE <- papa$BLOQUE
GraficoB <- ggplot(ind_coord, aes(x = PC1, y = PC2, label = ID, color = as.factor(BLOQUE))) +
geom_point(size = 2) +
geom_text(vjust = -0.3, size = 2) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("B) PCA – Distribución de unidades experimentales (B x R)") +
theme_minimal() +
guides(color = guide_legend(title = "Bloque"))
plot_grid(GraficoA, GraficoB, labels = c("A", "B"), ncol = 1)
loadings <- as.data.frame(pca_res$rotation[, 1:2])
loadings$variable <- rownames(loadings)
# Gráfico de flechas:
theta <- seq(0, 2*pi, length.out = 200)
circle <- data.frame(x = cos(theta), y = sin(theta))
GraficoA <- ggplot() +
geom_path(data = circle, aes(x = x, y = y), linetype = "dashed") +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.15, "cm")), color = "green") +
geom_text(data = loadings, aes(x = PC1, y = PC2, label = variable),
vjust = -0.5, color = "red", size = 3) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("A) PCA – Círculo de correlaciones") +
coord_equal() +
theme_minimal()
# Extraer coordenadas de los individuos "B#R#":
ind_coord <- as.data.frame(pca_res$x[, 1:2])
ind_coord$ID <- papa$ID
ind_coord$BLOQUE <- papa$BLOQUE
GraficoB <- ggplot(ind_coord, aes(x = PC1, y = PC2, label = ID, color = as.factor(BLOQUE))) +
geom_point(size = 2) +
geom_text(vjust = -0.3, size = 2) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("B) PCA – Distribución de unidades experimentales (B x R)") +
theme_minimal() +
guides(color = guide_legend(title = "Bloque"))
plot_grid(GraficoA, GraficoB, labels = c("A", "B"), ncol = 2)
papa <- papa %>%
mutate(ID = paste0("B", BLOQUE, "R", REPETICION))
autoplot(pca_res,
data = papa,
label = TRUE,
label.label = "ID",
colour = "BLOQUE",
loadings = TRUE,
loadings.label = TRUE) +
theme_minimal()
loadings <- as.data.frame(pca_res$rotation[, 1:2])
loadings$variable <- rownames(loadings)
# Gráfico de flechas:
theta <- seq(0, 2*pi, length.out = 200)
circle <- data.frame(x = cos(theta), y = sin(theta))
GraficoA <- ggplot() +
geom_path(data = circle, aes(x = x, y = y), linetype = "dashed") +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.15, "cm")), color = "green") +
geom_text(data = loadings, aes(x = PC1, y = PC2, label = variable),
vjust = -0.5, color = "brown", size = 3) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("A) PCA – Círculo de correlaciones") +
coord_equal() +
theme_minimal()
# Extraer coordenadas de los individuos "B#R#":
ind_coord <- as.data.frame(pca_res$x[, 1:2])
ind_coord$ID <- papa$ID
ind_coord$BLOQUE <- papa$BLOQUE
GraficoB <- ggplot(ind_coord, aes(x = PC1, y = PC2, label = ID, color = as.factor(BLOQUE))) +
geom_point(size = 2) +
geom_text(vjust = -0.3, size = 2) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("B) PCA – Distribución de unidades experimentales (B x R)") +
theme_minimal() +
guides(color = guide_legend(title = "Bloque"))
plot_grid(GraficoA, GraficoB, labels = c("A", "B"), ncol = 2)
# 1. Seleccionar solo las variables numéricas
datos_pca <- papa %>%
dplyr::select(Alt_plant_45_días,
Alt_plant_90_días,
Número_tubérculos_por_planta,
Peso_tubérculos_por_planta_kg)
# 2. PCA con las 4 variables y centrado / escalado
pca_res <- prcomp(datos_pca, scale. = TRUE)
# 3. Mostrar importancia de cada componente
summary(pca_res)
# 4. Loadings (peso de cada variable en los 4 componentes)
loadings <- pca_res$rotation
loadings
# 5. Coordenadas de los individuos en los 4 componentes
scores <- pca_res$x
head(scores)
# 6. (Opcional) Scree plot para ver los 4 componentes
fviz_eig(pca_res,
addlabels = TRUE,
ylim = c(0, 100),
main = "Porcentaje de varianza explicada (PC1 a PC4)")
# 7. Gráfico de individuos en 3D (PC1, PC2, PC3)
# install.packages("plotly")  # si no está instalado
library(plotly)
install.packages("plotly")
# 1. Seleccionar solo las variables numéricas
datos_pca <- papa %>%
dplyr::select(Alt_plant_45_días,
Alt_plant_90_días,
Número_tubérculos_por_planta,
Peso_tubérculos_por_planta_kg)
# 2. PCA con las 4 variables y centrado / escalado
pca_res <- prcomp(datos_pca, scale. = TRUE)
# 3. Mostrar importancia de cada componente
summary(pca_res)
# 4. Loadings (peso de cada variable en los 4 componentes)
loadings <- pca_res$rotation
loadings
# 5. Coordenadas de los individuos en los 4 componentes
scores <- pca_res$x
head(scores)
# 6. (Opcional) Scree plot para ver los 4 componentes
fviz_eig(pca_res,
addlabels = TRUE,
ylim = c(0, 100),
main = "Porcentaje de varianza explicada (PC1 a PC4)")
# 7. Gráfico de individuos en 3D (PC1, PC2, PC3)
# install.packages("plotly")  # si no está instalado
library(plotly)
plot_ly(data = as.data.frame(scores),
x = ~PC1, y = ~PC2, z = ~PC3,
type = "scatter3d", mode = "markers",
marker = list(size = 4)) %>%
layout(title = "PCA en 3 dimensiones (PC1, PC2, PC3)")
# 8. (Opcional) Matriz de dispersión PC1–PC4
pairs(scores[, 1:4], main = "Scatterplot matrix de los 4 PC")
loadings <- as.data.frame(pca_res$rotation[, 1:2])
loadings$variable <- rownames(loadings)
# Gráfico de flechas:
theta <- seq(0, 2*pi, length.out = 200)
circle <- data.frame(x = cos(theta), y = sin(theta))
GraficoA <- ggplot() +
geom_path(data = circle, aes(x = x, y = y), linetype = "dashed") +
geom_segment(data = loadings, aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.15, "cm")), color = "green") +
geom_text(data = loadings, aes(x = PC1, y = PC2, label = variable),
vjust = -0.5, color = "brown", size = 3) +
geom_hline(yintercept = 0) +
geom_vline(xintercept = 0) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("A) PCA – Círculo de correlaciones") +
coord_equal() +
theme_minimal()
# Extraer coordenadas de los individuos "B x R":
ind_coord <- as.data.frame(pca_res$x[, 1:2])
ind_coord$ID <- papa$ID
ind_coord$BLOQUE <- papa$BLOQUE
GraficoB <- ggplot(ind_coord, aes(x = PC1, y = PC2, label = ID, color = as.factor(BLOQUE))) +
geom_point(size = 2) +
geom_text(vjust = -0.3, size = 2) +
xlab(paste0("PC1 (", round(summary(pca_res)$importance[2,1] * 100, 2), "%)")) +
ylab(paste0("PC2 (", round(summary(pca_res)$importance[2,2] * 100, 2), "%)")) +
ggtitle("B) PCA – Distribución de unidades experimentales (B x R)") +
theme_minimal() +
guides(color = guide_legend(title = "Bloque"), size = 1)
plot_grid(GraficoA, GraficoB, labels = c("A", "B"), ncol = 2)
dtmv <- fb %>%
group_by(porcinaza, densidad) %>%
summarise(across(where(is.numeric)
, ~ mean(., na.rm = T))) %>%
unite("trat", c(porcinaza, densidad), remove = F) %>%
column_to_rownames("trat")
pca <- PCA(X = dtmv, scale.unit = T
, quali.sup = c(1, 2))
var <- plot(pca, choix = "var")
ind <- plot(pca, choix = "ind")
list(var, ind) %>%
plot_grid(plotlist = ., ncol = 2, labels = "auto")
dtmv <- fb %>%
group_by(porcinaza, densidad) %>%
summarise(across(where(is.numeric)
, ~ mean(., na.rm = T))) %>%
unite("trat", c(porcinaza, densidad), remove = F) %>%
column_to_rownames("trat")
summary(dtmv)
